<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">

<title>御雅堂</title>

<style type="text/css">

	body {
		
		margin: 0 auto;

		background-color: white;
	}
	header,footer {
		background-color: darkseagreen;
		padding: 20px 20px;
	}
	header,h1,h2 {
		margin: 0;
			
	}

footer {text-align: center;}
	h1,h2 {
		color: white;

	}
	img {
		width: 190px;
		height: 190px;
		margin: 2px;
	}

main {
	min-height: 800px;
	display: flex;
	flex-flow: row wrap;
}

ul {
	display: inline-block;
	list-style: none;
	margin: 0;
	padding: 0;
}
li {
	padding-left: 5px;
	display: inline-block;
}
div.img {
	border: 1px solid lightgray;
	width: 190px;
	height: 240px;
}
div.desc {

}
input {
	float: right;
	width: 200px;
	height: 30px;
	position: relative;
	top: 10px;
}
a#title {
	color: white;
	text-decoration: none;
}



/* The Modal (background) */
.modal {
  display: none; /* Hidden by default */
  position: fixed; /* Stay in place */
  z-index: 1; /* Sit on top */
  padding-top: 100px; /* Location of the box */
  left: 0;
  top: 0;
  width: 100%; /* Full width */
  height: 100%; /* Full height */
  overflow: auto; /* Enable scroll if needed */
  background-color: rgb(0,0,0); /* Fallback color */
  background-color: rgba(0,0,0,0.4); /* Black w/ opacity */
}

/* Modal Content */
.modal-content {
  background-color: #fefefe;
  margin: auto;
  padding: 20px;
  border: 1px solid #888;
  width: 80%;
}

/* The Close Button */
.close {
  color: #aaaaaa;
  float: right;
  font-size: 28px;
  font-weight: bold;
}

.close:hover,
.close:focus {
  color: #000;
  text-decoration: none;
  cursor: pointer;
}
</style>
<script>



window.onload=function() {upgraph();upcraft();upcategory();updatedata('');}

//const myweb="http://172.96.193.223/";
const myweb="";

function showmodal(){modal.style.display = 'block';}

function updatedata(str)
{
	
fetch(myweb+"product.php"+str).then(function(response) {
  response.text().then(function(text) {
    var jsonstr=JSON.parse(text);

			var mydiv = document.querySelector("main");
			mydiv.textContent="";
			for(var i = 0;i<jsonstr.length;i++){
				
				let d=document.createElement("div");
				
				d.setAttribute('class', "img");
				let a=document.createElement("a");
				// a.href="view.php?pid="+jsonstr[i].pid;
				// a.setAttribute('onclick', "alert('"+jsonstr[i].pid+"')");
				a.setAttribute('onclick', "showmodal('"+jsonstr[i].pid+"')");

				a.href="#"
				// a.target="_blank";
  				var img = document.createElement("img");
  				img.src=myweb+"thumbnail/"+jsonstr[i].image;
  				img.alt=jsonstr[i].image;
  				a.appendChild(img);
  				
  				let desc=document.createElement("a");
  				//desc.setAttribute('class', "desc");
  				desc.href="images/"+jsonstr[i].image;
  				desc.textContent=jsonstr[i].name;
  				d.appendChild(a);
  				d.appendChild(desc);

  				mydiv.appendChild(d);
  				//console.log(jsonstr[i].name);
 
			}
  });
});

}


function upgraph()
{
fetch(myweb+"list.php?table=graph").then(function(response) {
  response.text().then(function(text) {
    var jsonstr=JSON.parse(text);

			// var aside= document.querySelector("aside");
			// let ul=document.createElement("ul");
			var list = document.getElementById('keylist');
			for(var i = 0;i<jsonstr.length;i++){
				

  			// 	var li = document.createElement("li");
					// let a=document.createElement("a");
					// a.href="#";
					
					
					
					// a.setAttribute('onclick', "updatedata('?sid=" + jsonstr[i].sid + "')");
  			// 	a.textContent=jsonstr[i].name;
  			// 	li.appendChild(a);
  			// 	ul.appendChild(li);
  			   var option = document.createElement('option');
				   option.value = jsonstr[i].name;
				   list.appendChild(option);
  				
 
			}
			// aside.appendChild(ul);
  });
});

}

function upcraft()
{
fetch(myweb+"list.php?table=craft").then(function(response) {
  response.text().then(function(text) {
    var jsonstr=JSON.parse(text);

			// var aside= document.querySelector("aside");
			// let ul=document.createElement("ul");
			var list = document.getElementById('keylist');
			for(var i = 0;i<jsonstr.length;i++){
				

  			// 	var li = document.createElement("li");
					// let a=document.createElement("a");
					// a.href="#";
					
					
					
					// a.setAttribute('onclick', "updatedata('?sid=" + jsonstr[i].sid + "')");
  			// 	a.textContent=jsonstr[i].name;
  			// 	li.appendChild(a);
  			// 	ul.appendChild(li);
  			   var option = document.createElement('option');
				   option.value = jsonstr[i].name;
				   list.appendChild(option);
  				
 
			}
			// aside.appendChild(ul);
  });
});

}

function upcategory()
{
fetch(myweb+"list.php?table=style").then(function(response) {
  response.text().then(function(text) {
    var jsonstr=JSON.parse(text);

			var aside= document.querySelector("aside");
			// let ul=document.createElement("ul");
			var ul = document.getElementById('category');
			// var list = document.getElementById('keylist');
			for(var i = 0;i<jsonstr.length;i++){
				

  				var li = document.createElement("li");
					let a=document.createElement("a");
					a.href="#";
					
					
					
					a.setAttribute('onclick', "updatedata('?sid=" + jsonstr[i].sid + "')");
  				a.textContent=jsonstr[i].name;
  				li.appendChild(a);
  				ul.appendChild(li);
  			  //  var option = document.createElement('option');
				   // option.value = jsonstr[i].name;
				   // list.appendChild(option);
  				
 
			}
			// aside.appendChild(ul);
  });
});

}




</script>
</head>
<body>
<header>
	<h2>≡&nbsp;<a href="" id="title">
      <script type="text/javascript">
        document.write(document.title)
      </script></a>
<input type="search"  placeholder="查找..." onkeyup="updatedata('?key='+this.value)" list="keylist">
<datalist id="keylist"></datalist>
</h2>

</header>
<aside><ul id="category"></ul></aside>
<!-- The Modal -->
<div id="myModal" class="modal">

  <!-- Modal content -->
  <div class="modal-content" >
 <span class="close">&times;</span>   
    <div id="modal-content"></div>
  </div>

</div>

<script>
// Get the modal
var modal = document.getElementById("myModal");

// Get the button that opens the modal
// var btn = document.getElementById("myBtn");

// Get the <span> element that closes the modal
var span = document.getElementsByClassName("close")[0];

// When the user clicks the button, open the modal 
// btn.onclick = function() {
//   modal.style.display = "block";
// }

// When the user clicks on <span> (x), close the modal
span.onclick = function() {
  modal.style.display = "none";
}

// When the user clicks anywhere outside of the modal, close it
window.onclick = function(event) {
  if (event.target == modal) {
    modal.style.display = "none";
  }
}

function showmodal(pid) {

fetch(myweb+"product.php?pid="+pid).then(function(response) {
  response.text().then(function(text) {
    var jsonstr=JSON.parse(text);
		var modal = document.getElementById("modal-content");
		modal.innerHTML="";
  				var img = document.createElement("img");
  				img.src=myweb+"thumbnail/"+jsonstr[0].image;
  				img.alt=jsonstr[0].image;
  				modal.appendChild(img);		

  });
});	

	modal.style.display = 'block';
}
</script>
<main>

</main>

<footer><a href="mailto:jdzcn@qq.com">jdzcn@qq.com</a>&nbsp;<a href="admin/">后台管理</a></footer>
</body>
</html>
